{"version":3,"names":["_sfc_main","data","isDrawing","showResult","resultNumber","resultText","lots","number","text","showSettings","editableLots","popupReady","watch","val","_this","JSON","parse","stringify","$nextTick","$refs","settingsPopup","open","close","methods","drawLot","_this2","setTimeout","randomIndex","Math","floor","random","length","editLot","index","openSettings","_this3","closeSettings","updateLot","addNewLot","newNumber","push","deleteLot","splice","forEach","lot","idx","saveLots","common_vendor","showToast","title","icon","popupChange","e","show","onReady","wx","createPage","MiniProgramPage"],"sources":["draw-lots.vue","draw-lots.vue?type=page"],"sourcesContent":["<template>\n  <view class=\"draw-lots\">\n    <view class=\"lots-container\">\n      <view class=\"bamboo-tube\" :class=\"{ 'shaking': isDrawing }\">\n        <view class=\"tube-top\"></view>\n        <view class=\"tube-body\">\n          <view class=\"lots-sticks\">\n            <view class=\"stick\" v-for=\"i in 10\" :key=\"i\"></view>\n          </view>\n        </view>\n      </view>\n      \n      <view class=\"drawn-lot\" v-if=\"showResult && !isDrawing\">\n        <view class=\"stick-result\">\n          <view class=\"stick-head\"></view>\n          <view class=\"stick-body\"></view>\n        </view>\n        <text class=\"result-number\">第 {{resultNumber}} 签</text>\n        <text class=\"result-text\" @click=\"editLot(resultNumber - 1)\">{{resultText}}</text>\n      </view>\n      \n      <button class=\"draw-button\" \n              :disabled=\"isDrawing\"\n              @click=\"drawLot\">\n        {{ isDrawing ? '正在抽签...' : '抽签' }}\n      </button>\n\n      <button class=\"settings-button\" @click=\"openSettings\">\n        设置签内容\n      </button>\n    </view>\n\n    <!-- 设置弹窗 -->\n    <popup \n      ref=\"settingsPopup\" \n      type=\"center\" \n      @change=\"popupChange\" \n      v-if=\"showSettings\"\n    >\n      <view class=\"settings-popup\">\n        <view class=\"settings-header\">\n          <text class=\"settings-title\">设置签内容</text>\n          <text class=\"close-btn\" @click=\"closeSettings\">×</text>\n        </view>\n        <scroll-view scroll-y class=\"lots-list\">\n          <view v-for=\"(lot, index) in editableLots\" :key=\"index\" class=\"lot-item\">\n            <view class=\"lot-item-header\">\n              <text class=\"lot-number\">第{{lot.number}}签</text>\n              <text class=\"delete-btn\" @click=\"deleteLot(index)\">删除</text>\n            </view>\n            <input \n              class=\"lot-input\"\n              v-model=\"lot.text\"\n              placeholder=\"请输入签的内容\"\n              @blur=\"updateLot(index, lot.text)\"\n            />\n          </view>\n        </scroll-view>\n        <view class=\"popup-footer\">\n          <button class=\"add-button\" @click=\"addNewLot\">新增签</button>\n          <button class=\"save-button\" @click=\"saveLots\">保存设置</button>\n        </view>\n      </view>\n    </popup>\n  </view>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      isDrawing: false,\n      showResult: false,\n      resultNumber: 0,\n      resultText: '',\n      lots: [\n        { number: 1, text: '大吉 - 指定一人喝一杯，自己免喝' },\n        { number: 2, text: '中吉 - 与左边的人对饮一杯' },\n        { number: 3, text: '小吉 - 讲一个笑话，讲得不好喝一杯' },\n        { number: 4, text: '平签 - 猜拳决定喝酒人选' },\n        { number: 5, text: '末吉 - 自罚一杯，大家陪饮' },\n        { number: 6, text: '上吉 - 玩真心话大冒险，输者喝酒' },\n        { number: 7, text: '中平 - 与右边的人石头剪刀布，输者喝' },\n        { number: 8, text: '下签 - 表演节目，大家满意则免喝' },\n        { number: 9, text: '吉签 - 选择两人PK喝酒' },\n        { number: 10, text: '特签 - 所有人一起干杯！' }\n      ],\n      showSettings: false,\n      editableLots: [],\n      popupReady: false,\n    }\n  },\n  watch: {\n    showSettings(val) {\n      if (!this.popupReady) return\n      \n      if (val) {\n        this.editableLots = JSON.parse(JSON.stringify(this.lots))\n        this.$nextTick(() => {\n          if (this.$refs.settingsPopup) {\n            this.$refs.settingsPopup.open()\n          }\n        })\n      } else {\n        this.$refs.settingsPopup.close()\n      }\n    }\n  },\n  methods: {\n    drawLot() {\n      if (this.isDrawing) return\n      \n      this.isDrawing = true\n      this.showResult = false\n      \n      // 添加抽签动画延迟\n      setTimeout(() => {\n        const randomIndex = Math.floor(Math.random() * this.lots.length)\n        this.resultNumber = this.lots[randomIndex].number\n        this.resultText = this.lots[randomIndex].text\n        \n        this.isDrawing = false\n        this.showResult = true\n      }, 1500)\n    },\n    editLot(index) {\n      this.editableLots[index].text = this.lots[index].text\n      this.showSettings = true\n    },\n    \n    openSettings() {\n      this.editableLots = JSON.parse(JSON.stringify(this.lots))\n      this.showSettings = true\n      this.$nextTick(() => {\n        if (this.$refs.settingsPopup) {\n          this.$refs.settingsPopup.open()\n        }\n      })\n    },\n    \n    closeSettings() {\n      if (this.$refs.settingsPopup) {\n        this.$refs.settingsPopup.close()\n      }\n      this.showSettings = false\n    },\n    \n    updateLot(index, text) {\n      this.editableLots[index].text = text\n    },\n    \n    addNewLot() {\n      const newNumber = this.editableLots.length + 1\n      this.editableLots.push({\n        number: newNumber,\n        text: ''\n      })\n    },\n\n    deleteLot(index) {\n      this.editableLots.splice(index, 1)\n      // 重新编号\n      this.editableLots.forEach((lot, idx) => {\n        lot.number = idx + 1\n      })\n    },\n\n    saveLots() {\n      if (this.editableLots.length === 0) {\n        uni.showToast({\n          title: '至少需要一个签',\n          icon: 'none'\n        })\n        return\n      }\n      this.lots = JSON.parse(JSON.stringify(this.editableLots))\n      this.closeSettings()\n      uni.showToast({\n        title: '保存成功',\n        icon: 'success'\n      })\n    },\n    \n    popupChange(e) {\n      if (!e.show) {\n        this.showSettings = false\n      }\n    }\n  },\n  onReady() {\n    this.popupReady = true\n  }\n}\n</script>\n\n<style>\n.draw-lots {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  min-height: 100vh;\n  padding: 40rpx;\n  background: linear-gradient(to bottom, #0D0D2B 0%, #1A1A3A 100%);\n  position: relative;\n}\n\n.draw-lots::before {\n  content: '';\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: radial-gradient(circle at center, transparent 0%, #0D0D2B 70%);\n  animation: pulse 4s ease-in-out infinite;\n  z-index: 0;\n}\n\n.lots-container {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  width: 100%;\n  max-width: 600rpx;\n  position: relative;\n  z-index: 1;\n}\n\n.bamboo-tube {\n  width: 160rpx;\n  height: 400rpx;\n  margin: 60rpx 0;\n  position: relative;\n  background: rgba(26, 11, 46, 0.95);\n  border: 2px solid #ff00de;\n  box-shadow: 0 0 20px #ff00de;\n  border-radius: 80rpx;\n}\n\n.tube-top {\n  width: 160rpx;\n  height: 30rpx;\n  background: rgba(26, 11, 46, 0.95);\n  border-radius: 80rpx 80rpx 0 0;\n  border-top: 2px solid #ff00de;\n  border-left: 2px solid #ff00de;\n  border-right: 2px solid #ff00de;\n  box-shadow: 0 0 10px #ff00de;\n}\n\n.tube-body {\n  width: 160rpx;\n  height: 370rpx;\n  background: rgba(26, 11, 46, 0.95);\n  position: relative;\n  overflow: hidden;\n}\n\n.lots-sticks {\n  position: absolute;\n  top: 10rpx;\n  left: 50%;\n  transform: translateX(-50%);\n  width: 120rpx;\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: center;\n  gap: 6rpx;\n}\n\n.stick {\n  width: 8rpx;\n  height: 300rpx;\n  background: #00f7ff;\n  border-radius: 4rpx;\n  box-shadow: 0 0 5px #00f7ff;\n}\n\n.shaking {\n  animation: tubeShake 0.15s ease-in-out infinite;\n}\n\n@keyframes tubeShake {\n  0%, 100% { \n    transform: rotate(0deg); \n  }\n  25% { \n    transform: rotate(-5deg); \n  }\n  75% { \n    transform: rotate(5deg); \n  }\n}\n\n.drawn-lot {\n  margin: 40rpx 0;\n  padding: 30rpx;\n  width: 100%;\n  background: rgba(26, 11, 46, 0.95);\n  border: 2px solid #ff00de;\n  box-shadow: 0 0 15px #ff00de;\n  border-radius: 16rpx;\n  text-align: center;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n}\n\n.stick-result {\n  width: 8rpx;\n  height: 200rpx;\n  margin-bottom: 20rpx;\n}\n\n.stick-head {\n  width: 16rpx;\n  height: 16rpx;\n  background: #00f7ff;\n  border-radius: 50%;\n  margin: 0 auto;\n  box-shadow: 0 0 5px #00f7ff;\n}\n\n.stick-body {\n  width: 8rpx;\n  height: 184rpx;\n  background: #00f7ff;\n  border-radius: 4rpx;\n  margin: 0 auto;\n  box-shadow: 0 0 5px #00f7ff;\n}\n\n.result-number {\n  font-size: 36rpx;\n  color: #fff;\n  margin: 20rpx 0;\n  text-shadow: 0 0 5px #fff,\n               0 0 10px #00f7ff,\n               0 0 15px #00f7ff;\n}\n\n.result-text {\n  font-size: 32rpx;\n  color: #fff;\n  line-height: 1.5;\n  text-decoration: underline;\n  text-shadow: 0 0 5px #fff,\n               0 0 10px #00f7ff;\n}\n\n.draw-button {\n  width: 80%;\n  height: 88rpx;\n  line-height: 88rpx;\n  border-radius: 44rpx;\n  background: rgba(26, 11, 46, 0.95);\n  color: #fff;\n  font-size: 32rpx;\n  border: 2px solid #ff00de;\n  box-shadow: 0 0 15px #ff00de;\n  margin-top: 40rpx;\n  text-shadow: 0 0 5px #fff;\n}\n\n.draw-button:active {\n  transform: scale(0.98);\n  box-shadow: 0 0 25px #ff00de;\n}\n\n.draw-button[disabled] {\n  opacity: 0.7;\n  box-shadow: none;\n}\n\n.settings-button {\n  width: 80%;\n  height: 88rpx;\n  line-height: 88rpx;\n  border-radius: 44rpx;\n  background: rgba(26, 11, 46, 0.95);\n  color: #fff;\n  font-size: 32rpx;\n  border: 2px solid #00f7ff;\n  box-shadow: 0 0 15px #00f7ff;\n  margin-top: 20rpx;\n  text-shadow: 0 0 5px #fff;\n}\n\n.settings-popup {\n  width: 600rpx;\n  background: rgba(26, 11, 46, 0.95);\n  border-radius: 20rpx;\n  padding: 30rpx;\n  border: 2px solid #ff00de;\n  box-shadow: 0 0 20px #ff00de;\n}\n\n.settings-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 30rpx;\n}\n\n.settings-title {\n  color: #fff;\n  font-size: 36rpx;\n  text-shadow: 0 0 5px #fff,\n               0 0 10px #00f7ff;\n}\n\n.close-btn {\n  color: #fff;\n  font-size: 48rpx;\n  padding: 0 20rpx;\n  text-shadow: 0 0 5px #fff;\n  cursor: pointer;\n}\n\n.close-btn:active {\n  opacity: 0.7;\n}\n\n.lots-list {\n  max-height: 800rpx;\n}\n\n.lot-item {\n  margin-bottom: 20rpx;\n  padding: 20rpx;\n  background: rgba(26, 11, 46, 0.95);\n  border: 1px solid #00f7ff;\n  box-shadow: 0 0 10px #00f7ff;\n  border-radius: 10rpx;\n}\n\n.lot-item-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 10rpx;\n}\n\n.lot-number {\n  display: block;\n  color: #fff;\n  font-size: 28rpx;\n  margin-bottom: 10rpx;\n  text-shadow: 0 0 5px #fff,\n               0 0 10px #00f7ff;\n}\n\n.delete-btn {\n  color: #ff4444;\n  font-size: 28rpx;\n  padding: 4rpx 12rpx;\n  border: 1px solid #ff4444;\n  border-radius: 6rpx;\n  text-shadow: 0 0 5px #ff4444;\n}\n\n.lot-input {\n  width: 100%;\n  height: 70rpx;\n  background: rgba(26, 11, 46, 0.95);\n  border: 1px solid #ff00de;\n  box-shadow: 0 0 5px #ff00de;\n  border-radius: 8rpx;\n  padding: 0 20rpx;\n  color: #fff;\n  font-size: 28rpx;\n}\n\n.popup-footer {\n  display: flex;\n  gap: 20rpx;\n  margin-top: 30rpx;\n}\n\n.add-button {\n  flex: 1;\n  height: 88rpx;\n  line-height: 88rpx;\n  border-radius: 44rpx;\n  background: rgba(26, 11, 46, 0.95);\n  color: #fff;\n  font-size: 32rpx;\n  border: 2px solid #00f7ff;\n  box-shadow: 0 0 15px #00f7ff;\n  text-shadow: 0 0 5px #fff;\n}\n\n.save-button {\n  flex: 1;\n  height: 88rpx;\n  line-height: 88rpx;\n  border-radius: 44rpx;\n  background: rgba(26, 11, 46, 0.95);\n  color: #fff;\n  font-size: 32rpx;\n  border: 2px solid #ff00de;\n  box-shadow: 0 0 15px #ff00de;\n  text-shadow: 0 0 5px #fff;\n}\n\n.save-button:active {\n  transform: scale(0.98);\n  box-shadow: 0 0 25px #ff00de;\n}\n\n@keyframes pulse {\n  0% { opacity: 0.5; }\n  50% { opacity: 0.8; }\n  100% { opacity: 0.5; }\n}\n</style> ","import MiniProgramPage from '/Users/weitao/Desktop/ThinGift/drink-app/pages/game/draw-lots.vue'\nwx.createPage(MiniProgramPage)"],"mappings":"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","ignoreList":[]}